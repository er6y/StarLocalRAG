# StarLocalRAG

<div align="center">

![StarLocalRAG Logo](https://img.shields.io/badge/StarLocalRAG-Local%20RAG%20Solution-blue?style=for-the-badge)

**ğŸš€ å®Œå…¨æœ¬åœ°åŒ–çš„Android RAGåº”ç”¨ | Fully Local Android RAG Application**

[![Android](https://img.shields.io/badge/Android-3DDC84?style=flat-square&logo=android&logoColor=white)](https://developer.android.com/)
[![Java](https://img.shields.io/badge/Java-ED8B00?style=flat-square&logo=openjdk&logoColor=white)](https://www.java.com/)
[![Rust](https://img.shields.io/badge/Rust-000000?style=flat-square&logo=rust&logoColor=white)](https://www.rust-lang.org/)
[![ONNX](https://img.shields.io/badge/ONNX-005CED?style=flat-square&logo=onnx&logoColor=white)](https://onnx.ai/)
[![LlamaCpp](https://img.shields.io/badge/LlamaCpp-FF6B6B?style=flat-square)](https://github.com/ggerganov/llama.cpp)


## ç¤ºä¾‹demo

çŸ¥è¯†åº“æ„å»º 
![e0f8b519a5d3ab1e99e6dcba518114e5](https://github.com/user-attachments/assets/d7f938b6-56fe-46d2-add2-e3f6d59dc6e9)
åœ¨çº¿å¤§æ¨¡å‹ç¤ºä¾‹
![35d9dc5fbe5b59b2c3563185357ede76](https://github.com/user-attachments/assets/10057e1f-1957-4996-9db5-1f4dff23c739)
æœ¬åœ°å°æ¨¡å‹ç¤ºä¾‹
![84bffc5557514eabd43177546d2f800e](https://github.com/user-attachments/assets/fc1e5930-93c3-48e6-8eb6-caeffa144eab)
![29683f1ba196413c18c851a8245f7b84](https://github.com/user-attachments/assets/a1180485-40d3-4581-bfb0-fd5ebb217c84)

[English](#english) | [ä¸­æ–‡](#ä¸­æ–‡)

</div>

---

## ä¸­æ–‡

### ğŸ“– é¡¹ç›®ç®€ä»‹

StarLocalRAG æ˜¯ä¸€ä¸ªåŸºäºAndroidå¹³å°çš„**å®Œå…¨æœ¬åœ°åŒ–RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰åº”ç”¨**ï¼Œæ”¯æŒç¦»çº¿çŸ¥è¯†åº“æ„å»ºã€æ–‡æ¡£æ£€ç´¢å’Œæ™ºèƒ½é—®ç­”ã€‚æ‰€æœ‰AIæ¨ç†å’Œæ•°æ®å¤„ç†éƒ½åœ¨è®¾å¤‡æœ¬åœ°è¿›è¡Œï¼Œç¡®ä¿ç”¨æˆ·æ•°æ®éšç§å’Œå®‰å…¨ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

#### ğŸ”’ **å®Œå…¨æœ¬åœ°åŒ–**
- æ‰€æœ‰AIæ¨ç†åœ¨è®¾å¤‡æœ¬åœ°æ‰§è¡Œï¼Œæ— éœ€è”ç½‘
- æ”¯æŒæœ¬åœ°LLMæ¨¡å‹å’Œåœ¨çº¿APIåŒæ¨¡å¼
- æ•°æ®å®Œå…¨ä¿ç•™åœ¨æœ¬åœ°ï¼Œä¿æŠ¤ç”¨æˆ·éšç§

#### ğŸ§  **å¤šå¼•æ“AIæ¨ç†**
- **LlamaCppå¼•æ“**ï¼šæ”¯æŒGGUFæ ¼å¼æ¨¡å‹ï¼Œä¼˜åŒ–å†…å­˜ä½¿ç”¨
- **ONNX Runtime 1.21.0**ï¼šé«˜æ€§èƒ½æ¨ç†ï¼Œæ”¯æŒGPUåŠ é€Ÿ
- **Ruståˆ†è¯å™¨**ï¼šé«˜æ•ˆçš„å¤šæ¶æ„åˆ†è¯å¤„ç†ï¼ˆARM64/ARMv7/x86_64ï¼‰

#### ğŸ“š **æ™ºèƒ½çŸ¥è¯†åº“ç³»ç»Ÿ**
- æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼šPDFã€Wordã€Excelã€PPTã€TXTã€JSON
- æ™ºèƒ½æ–‡æœ¬åˆ†å—ç­–ç•¥ï¼šå›ºå®šé•¿åº¦ã€è¯­ä¹‰åˆ†å—ã€å±‚æ¬¡åŒ–åˆ†å—
- å‘é‡å¼‚å¸¸æ£€æµ‹ä¸ä¿®å¤ç³»ç»Ÿï¼Œç¡®ä¿æ£€ç´¢è´¨é‡
- SQLiteæœ¬åœ°å‘é‡æ•°æ®åº“ï¼Œé«˜æ•ˆå­˜å‚¨å’Œæ£€ç´¢

#### ğŸ” **é«˜çº§æ£€ç´¢æŠ€æœ¯**
- **å‘é‡æ£€ç´¢**ï¼šåŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦çš„ç²¾ç¡®åŒ¹é…
- **é‡æ’æ¨¡å‹**ï¼šäºŒæ¬¡æ’åºæå‡æ£€ç´¢ç›¸å…³æ€§
- **å¤šæ¨¡æ€æ”¯æŒ**ï¼šæ–‡æœ¬ã€ä»£ç ã€ç»“æ„åŒ–æ•°æ®ç»Ÿä¸€å¤„ç†

#### âš¡ **æ€§èƒ½ä¼˜åŒ–**
- **æµå¼è¾“å‡º**ï¼šå®æ—¶æ˜¾ç¤ºAIç”Ÿæˆå†…å®¹
- **å¹¶å‘æ§åˆ¶**ï¼šåŸå­æ“ä½œå’Œçº¿ç¨‹å®‰å…¨è®¾è®¡
- **å†…å­˜ä¼˜åŒ–**ï¼šæ™ºèƒ½ç¼“å­˜å’Œèµ„æºç®¡ç†
- **æ¨ç†ä¸­æ–­**ï¼šæ”¯æŒå®æ—¶åœæ­¢å’Œæ¢å¤

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

#### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    StarLocalRAG æ¶æ„                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI Layer (Android)                                         â”‚
â”‚  â”œâ”€â”€ RAGé—®ç­”ç•Œé¢    â”œâ”€â”€ çŸ¥è¯†åº“æ„å»º    â”œâ”€â”€ æ¨¡å‹ç®¡ç†           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Business Logic Layer                                       â”‚
â”‚  â”œâ”€â”€ RagQueryManager  â”œâ”€â”€ KnowledgeBaseService              â”‚
â”‚  â”œâ”€â”€ EmbeddingModelManager  â”œâ”€â”€ RerankerModelManager        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AI Inference Layer                                         â”‚
â”‚  â”œâ”€â”€ LocalLlmHandler (LlamaCpp)                            â”‚
â”‚  â”œâ”€â”€ EmbeddingModelHandler (ONNX)                          â”‚
â”‚  â”œâ”€â”€ TokenizerManager (Rust JNI)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data Layer                                                 â”‚
â”‚  â”œâ”€â”€ SQLiteVectorDatabase  â”œâ”€â”€ DocumentParser              â”‚
â”‚  â”œâ”€â”€ TextChunkProcessor    â”œâ”€â”€ VectorAnomalyHandler        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### çº¿ç¨‹æ¶æ„è®¾è®¡

- **Main Thread (UI)**ï¼šç”¨æˆ·ç•Œé¢äº¤äº’å’ŒçŠ¶æ€ç®¡ç†
- **RagQa-Query-Thread**ï¼šRAGæŸ¥è¯¢æ‰§è¡Œå’Œæ¨¡å‹è°ƒç”¨
- **RagQa-StopCheck-Thread**ï¼šä»»åŠ¡çŠ¶æ€ç›‘æ§å’Œé˜²å‘†æœºåˆ¶
- **API Thread Pool**ï¼šåœ¨çº¿æ¨¡å‹HTTPè¯·æ±‚å¤„ç†

### ğŸš€ æŠ€æœ¯äº®ç‚¹

#### 1. **é«˜æ€§èƒ½åˆ†è¯ç³»ç»Ÿ**
```rust
// Rustæ ¸å¿ƒåˆ†è¯å™¨ï¼Œç›´æ¥JNIæ¥å£
// æ”¯æŒç‰¹æ®Štokenå¤„ç†ï¼š```, ```
// å¤šæ¶æ„ä¼˜åŒ–ï¼šARM64, ARMv7, x86_64
```

#### 2. **å‘é‡å¼‚å¸¸å¤„ç†ç³»ç»Ÿ**
- **å¼‚å¸¸æ£€æµ‹**ï¼šNaNå€¼ã€æ— ç©·å¤§ã€ç»´åº¦ä¸åŒ¹é…ã€åˆ†å¸ƒå¼‚å¸¸
- **è‡ªåŠ¨ä¿®å¤**ï¼šé›¶å‘é‡å¤„ç†ã€æå€¼ä¿®æ­£ã€ç»´åº¦å¯¹é½
- **è´¨é‡è¯„ä¼°**ï¼šå‘é‡è´¨é‡æŠ¥å‘Šå’Œç»Ÿè®¡åˆ†æ

#### 3. **æ™ºèƒ½å¹¶å‘æ§åˆ¶**
```java
// åŸå­æ“ä½œå®ç°æ— é”å¹¶å‘æ§åˆ¶
AtomicBoolean isBusy = new AtomicBoolean(false);
if (isBusy.compareAndSet(false, true)) {
    // æ‰§è¡Œæ¨ç†ä»»åŠ¡
}
```

#### 4. **å…¨å±€åœæ­¢æœºåˆ¶**
- ç»Ÿä¸€çš„`GlobalStopManager`ç®¡ç†æ‰€æœ‰AIæ¨¡å—
- ä¸»åŠ¨è½®è¯¢æœºåˆ¶ï¼Œå®ç°å³æ—¶å“åº”ç”¨æˆ·ä¸­æ–­
- ä¼˜é›…çš„èµ„æºé‡Šæ”¾å’ŒçŠ¶æ€æ¢å¤

### ğŸ“± åŠŸèƒ½æ¨¡å—

#### RAGé—®ç­”ç³»ç»Ÿ
- åŸºäºçŸ¥è¯†åº“çš„æ™ºèƒ½é—®ç­”
- æ”¯æŒæ€è€ƒæ¨¡å¼ï¼ˆ`/no_think`æŒ‡ä»¤ï¼‰
- æµå¼è¾“å‡ºå’Œå®æ—¶ä¸­æ–­
- å¤šå‚æ•°é…ç½®ï¼šæ£€ç´¢æ·±åº¦ã€é‡æ’æ•°é‡ç­‰

#### çŸ¥è¯†åº“æ„å»º
- å¤šæ ¼å¼æ–‡æ¡£è§£æå’Œå¤„ç†
- æ™ºèƒ½æ–‡æœ¬åˆ†å—ç­–ç•¥
- å‘é‡åŒ–å’Œæ•°æ®åº“å­˜å‚¨
- æ¨¡å‹å…¼å®¹æ€§æ£€æŸ¥

#### æ¨¡å‹ç®¡ç†
- æœ¬åœ°æ¨¡å‹ä¸‹è½½å’Œç®¡ç†
- æ–­ç‚¹ç»­ä¼ å’Œæ™ºèƒ½é‡è¯•
- å¤šæ¨¡å‹å¹¶å‘ä¸‹è½½
- GPUé…ç½®æ£€æµ‹å’Œä¼˜åŒ–

### ğŸ› ï¸ å¼€å‘ç¯å¢ƒ

#### ç³»ç»Ÿè¦æ±‚
- Android 7.0+ (API Level 24+)
- 4GB+ RAMï¼ˆæ¨è8GB+ï¼‰
- 2GB+ å¯ç”¨å­˜å‚¨ç©ºé—´

#### æ„å»ºä¾èµ–
- Android Studio 2023.1+
- Gradle 8.0+
- NDK 25.0+
- Rust 1.70+

#### ç¼–è¯‘æ„å»º
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/StarLocalRAG.git
cd StarLocalRAG

# åˆå§‹åŒ–å­æ¨¡å—
git submodule update --init --recursive

# æ„å»ºRuståˆ†è¯å™¨
cd libs/tokenizers-rust
cargo build --release

# æ„å»ºAndroidåº”ç”¨
./gradlew assembleDebug
```

### ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| åˆ†è¯é€Ÿåº¦ | 10K+ tokens/s | Rustä¼˜åŒ–å®ç° |
| å‘é‡æ£€ç´¢ | <100ms | SQLiteä¼˜åŒ–æŸ¥è¯¢ |
| å†…å­˜å ç”¨ | <2GB | æ™ºèƒ½ç¼“å­˜ç®¡ç† |
| æ¨¡å‹åŠ è½½ | <30s | å¹¶å‘ä¼˜åŒ–åŠ è½½ |

### ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

#### è´¡çŒ®æ–¹å¼
- ğŸ› æŠ¥å‘ŠBugå’Œé—®é¢˜
- ğŸ’¡ æå‡ºæ–°åŠŸèƒ½å»ºè®®
- ğŸ“ æ”¹è¿›æ–‡æ¡£
- ğŸ”§ æäº¤ä»£ç ä¿®å¤

### ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

### ğŸ¤– AIé©±åŠ¨å¼€å‘

**âš¡ è¿™æ˜¯ä¸€ä¸ªå®Œå…¨ç”±AIæ’°å†™çš„é¡¹ç›®ï¼**

æœ¬é¡¹ç›®æ˜¯AIç¼–ç¨‹èƒ½åŠ›çš„ä¸€æ¬¡æ·±åº¦å®è·µï¼Œå±•ç¤ºäº†ç°ä»£AIåœ¨å¤æ‚è½¯ä»¶å¼€å‘ä¸­çš„æ½œåŠ›ï¼š

#### ğŸ› ï¸ **å¼€å‘å·¥å…·é“¾**
- **ä¸»è¦AI IDE**: Lingma - ä¸–ç•Œé¢†å…ˆçš„AIç¼–ç¨‹ç¯å¢ƒ
- **æ ¸å¿ƒAIæ¨¡å‹**: qwen3-coder - æä¾›ä¸»è¦çš„ä»£ç ç”Ÿæˆå’Œæ¶æ„è®¾è®¡

#### ğŸ’¡ **AIç¼–ç¨‹å®è·µ**
- **å®Œå…¨AIç”Ÿæˆ**: ä»æ¶æ„è®¾è®¡åˆ°å…·ä½“å®ç°ï¼Œå…¨éƒ¨ç”±AIå®Œæˆ
- **è¿­ä»£ä¼˜åŒ–**: é€šè¿‡AIå¯¹è¯æŒç»­æ”¹è¿›ä»£ç è´¨é‡å’ŒåŠŸèƒ½

#### ğŸ” **æŠ€æœ¯å±€é™æ€§**
å—é™äºå½“å‰å¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œç‰¹åˆ«æ˜¯é•¿æœŸè®°å¿†å’Œå…¨å±€æ¶æ„ç†è§£èƒ½åŠ›ï¼Œé¡¹ç›®ä¸­å¯èƒ½å­˜åœ¨ï¼š
- éƒ¨åˆ†ä»£ç ç»“æ„å†—ä½™
- æŸäº›è®¾è®¡å±‚æ¬¡ä¸å¤Ÿåˆç†
- å±€éƒ¨ä¼˜åŒ–ä¸å…¨å±€ä¸€è‡´æ€§çš„å¹³è¡¡é—®é¢˜

å°½ç®¡å¦‚æ­¤ï¼Œè¿™ä¸ªé¡¹ç›®ä»ç„¶æ˜¯**AIç¼–ç¨‹èƒ½åŠ›çš„ä¼˜ç§€å±•ç¤º**ï¼Œè¯æ˜äº†AIåœ¨å¤æ‚è½¯ä»¶å¼€å‘ä¸­çš„å·¨å¤§æ½œåŠ›ã€‚



#### å¼€æºé¡¹ç›®æ”¯æŒ
æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š
- [llama.cpp](https://github.com/ggerganov/llama.cpp) - é«˜æ€§èƒ½LLMæ¨ç†å¼•æ“
- [ONNX Runtime](https://github.com/microsoft/onnxruntime) - è·¨å¹³å°AIæ¨ç†æ¡†æ¶
- [Tokenizers](https://github.com/huggingface/tokenizers) - é«˜æ•ˆåˆ†è¯å™¨åº“

---

## English

### ğŸ“– Project Overview

StarLocalRAG is a **fully local RAG (Retrieval-Augmented Generation) application** for Android that supports offline knowledge base construction, document retrieval, and intelligent Q&A. All AI inference and data processing are performed locally on the device, ensuring user data privacy and security.

### âœ¨ Key Features

#### ğŸ”’ **Fully Local**
- All AI inference runs locally on device, no internet required
- Supports both local LLM models and online API modes
- Data stays completely local, protecting user privacy

#### ğŸ§  **Multi-Engine AI Inference**
- **LlamaCpp Engine**: Supports GGUF format models with optimized memory usage
- **ONNX Runtime 1.21.0**: High-performance inference with GPU acceleration
- **Rust Tokenizer**: Efficient multi-architecture tokenization (ARM64/ARMv7/x86_64)

#### ğŸ“š **Intelligent Knowledge Base System**
- Multiple document formats: PDF, Word, Excel, PPT, TXT, JSON
- Smart text chunking strategies: fixed-length, semantic, hierarchical
- Vector anomaly detection and repair system for quality assurance
- SQLite local vector database for efficient storage and retrieval

#### ğŸ” **Advanced Retrieval Technology**
- **Vector Retrieval**: Precise matching based on semantic similarity
- **Rerank Models**: Secondary ranking to improve retrieval relevance
- **Multi-modal Support**: Unified processing for text, code, and structured data

#### âš¡ **Performance Optimization**
- **Streaming Output**: Real-time display of AI-generated content
- **Concurrency Control**: Atomic operations and thread-safe design
- **Memory Optimization**: Smart caching and resource management
- **Inference Interruption**: Real-time stop and resume support

### ğŸ—ï¸ Technical Architecture

#### Core Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    StarLocalRAG Architecture                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI Layer (Android)                                         â”‚
â”‚  â”œâ”€â”€ RAG Q&A Interface  â”œâ”€â”€ Knowledge Base  â”œâ”€â”€ Model Mgmt  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Business Logic Layer                                       â”‚
â”‚  â”œâ”€â”€ RagQueryManager  â”œâ”€â”€ KnowledgeBaseService              â”‚
â”‚  â”œâ”€â”€ EmbeddingModelManager  â”œâ”€â”€ RerankerModelManager        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AI Inference Layer                                         â”‚
â”‚  â”œâ”€â”€ LocalLlmHandler (LlamaCpp)                            â”‚
â”‚  â”œâ”€â”€ EmbeddingModelHandler (ONNX)                          â”‚
â”‚  â”œâ”€â”€ TokenizerManager (Rust JNI)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data Layer                                                 â”‚
â”‚  â”œâ”€â”€ SQLiteVectorDatabase  â”œâ”€â”€ DocumentParser              â”‚
â”‚  â”œâ”€â”€ TextChunkProcessor    â”œâ”€â”€ VectorAnomalyHandler        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Thread Architecture Design

- **Main Thread (UI)**: User interface interaction and state management
- **RagQa-Query-Thread**: RAG query execution and model calls
- **RagQa-StopCheck-Thread**: Task status monitoring and safety mechanisms
- **API Thread Pool**: Online model HTTP request handling

### ğŸš€ Technical Highlights

#### 1. **High-Performance Tokenization System**
```rust
// Rust core tokenizer with direct JNI interface
// Special token support: ```, ```
// Multi-architecture optimization: ARM64, ARMv7, x86_64
```

#### 2. **Vector Anomaly Handling System**
- **Anomaly Detection**: NaN values, infinity, dimension mismatch, distribution anomalies
- **Auto Repair**: Zero vector handling, extreme value correction, dimension alignment
- **Quality Assessment**: Vector quality reports and statistical analysis

#### 3. **Smart Concurrency Control**
```java
// Lock-free concurrency control with atomic operations
AtomicBoolean isBusy = new AtomicBoolean(false);
if (isBusy.compareAndSet(false, true)) {
    // Execute inference task
}
```

#### 4. **Global Stop Mechanism**
- Unified `GlobalStopManager` for all AI modules
- Active polling mechanism for immediate user interrupt response
- Graceful resource release and state recovery

### ğŸ“± Functional Modules

#### RAG Q&A System
- Knowledge base-driven intelligent Q&A
- Think mode support (`/no_think` command)
- Streaming output and real-time interruption
- Multi-parameter configuration: retrieval depth, rerank count, etc.

#### Knowledge Base Construction
- Multi-format document parsing and processing
- Smart text chunking strategies
- Vectorization and database storage
- Model compatibility checking

#### Model Management
- Local model download and management
- Resume download and smart retry
- Concurrent multi-model downloads
- GPU configuration detection and optimization

### ğŸ› ï¸ Development Environment

#### System Requirements
- Android 7.0+ (API Level 24+)
- 4GB+ RAM (8GB+ recommended)
- 2GB+ available storage

#### Build Dependencies
- Android Studio 2023.1+
- Gradle 8.0+
- NDK 25.0+
- Rust 1.70+

#### Build Instructions
```bash
# Clone the project
git clone https://github.com/yourusername/StarLocalRAG.git
cd StarLocalRAG

# Initialize submodules
git submodule update --init --recursive

# Build Rust tokenizer
cd libs/tokenizers-rust
cargo build --release

# Build Android app
./gradlew assembleDebug
```

### ğŸ“Š Performance Metrics

| Metric | Value | Description |
|--------|-------|-------------|
| Tokenization Speed | 10K+ tokens/s | Rust-optimized implementation |
| Vector Retrieval | <100ms | SQLite-optimized queries |
| Memory Usage | <2GB | Smart cache management |
| Model Loading | <30s | Concurrent optimized loading |

### ğŸ¤ Contributing

We welcome community contributions! Please see [CONTRIBUTING.md](CONTRIBUTING.md) for details.

#### Ways to Contribute
- ğŸ› Report bugs and issues
- ğŸ’¡ Suggest new features
- ğŸ“ Improve documentation
- ğŸ”§ Submit code fixes

### ğŸ“„ License

This project is licensed under the [MIT License](LICENSE).

### ğŸ¤– AI-Driven Development

**âš¡ This is a project entirely written by AI!**

This project represents a deep practice of AI programming capabilities, showcasing the potential of modern AI in complex software development:

#### ğŸ› ï¸ **Development Toolchain**
- **Primary AI IDE**: Lingma - World's leading AI programming environment
- **Core AI Model**: qwen3-coder - Providing main code generation and architecture design

#### ğŸ’¡ **AI Programming Practice**
- **Fully AI Generated**: From architecture design to specific implementation, all completed by AI
- **Iterative Optimization**: Continuous improvement of code quality and functionality through AI dialogue

#### ğŸ” **Technical Limitations**
Limited by current large model capabilities, especially long-term memory and global architecture understanding, the project may have:
- Some redundant code structures
- Certain design hierarchies that are not reasonable enough
- Balance issues between local optimization and global consistency

Nevertheless, this project remains an **excellent demonstration of AI programming capabilities**, proving the tremendous potential of AI in complex software development.



#### Open Source Project Support
Thanks to the following open source projects:
- [llama.cpp](https://github.com/ggerganov/llama.cpp) - High-performance LLM inference engine
- [ONNX Runtime](https://github.com/microsoft/onnxruntime) - Cross-platform AI inference framework
- [Tokenizers](https://github.com/huggingface/tokenizers) - Efficient tokenizer library

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼**

**â­ If this project helps you, please give us a star!**

</div>
